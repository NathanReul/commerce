{"version":3,"file":"CatalogPricing.js","mappings":"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","sources":["webpack:///./js/CatalogPricing.js"],"sourcesContent":["/* jshint esversion: 6 */\n/* globals Craft, Garnish, $ */\nif (typeof Craft.Commerce === typeof undefined) {\n  Craft.Commerce = {};\n}\n\nCraft.Commerce.CatalogPricing = Garnish.Base.extend({\n  $clearSearchBtn: null,\n  $filterBtn: null,\n  $search: null,\n  $searchContainer: null,\n  $tableContainer: null,\n  filterHuds: {},\n  searchTimeout: null,\n  searching: false,\n  view: null,\n  defaults: {},\n\n  init: function (view, tableContainer, settings) {\n    this.view = view;\n    this.$tableContainer = tableContainer;\n    this.$searchContainer = this.view.find('.search-container:first');\n    this.$search = this.$searchContainer.find('input:first');\n    this.$clearSearchBtn = this.$searchContainer.children('.clear-btn:first');\n    this.$filterBtn = this.$searchContainer.children('.filter-btn:first');\n    this.setSettings(settings, this.defaults);\n\n    if (this.settings.filterBtnActive) {\n      this.$filterBtn.addClass('active');\n    }\n\n    this.addListener(this.$filterBtn, 'click', 'showFilterHud');\n\n    this.addListener(this.$search, 'input', () => {\n      if (!this.searching && this.$search.val()) {\n        this.startSearching();\n      } else if (this.searching && !this.$search.val()) {\n        this.stopSearching();\n      }\n\n      if (this.searchTimeout) {\n        clearTimeout(this.searchTimeout);\n      }\n\n      this.searchTimeout = setTimeout(\n        this.updateTableIfSearchTextChanged.bind(this),\n        500\n      );\n    });\n\n    // Clear the search when the X button is clicked\n    this.addListener(this.$clearSearchBtn, 'click', () => {\n      this.clearSearch(true);\n\n      if (!Garnish.isMobileBrowser(true)) {\n        this.$search.trigger('focus');\n      }\n    });\n  },\n\n  startSearching: function () {\n    // Show the clear button\n    this.$clearSearchBtn.removeClass('hidden');\n    this.searching = true;\n  },\n\n  clearSearch: function (updateTable) {\n    if (!this.searching) {\n      return;\n    }\n\n    this.$search.val('');\n\n    if (this.searchTimeout) {\n      clearTimeout(this.searchTimeout);\n    }\n\n    this.stopSearching();\n\n    if (updateTable) {\n      this.updateTableIfSearchTextChanged();\n    } else {\n      this.searchText = null;\n    }\n  },\n\n  stopSearching: function () {\n    // Hide the clear button\n    this.$clearSearchBtn.addClass('hidden');\n    this.searching = false;\n  },\n\n  showFilterHud: function () {\n    if (!this.getFilterHud()) {\n      this.createFilterHud();\n      this.updateFilterBtn();\n    } else {\n      this.getFilterHud().show();\n    }\n  },\n\n  updateFilterBtn: function () {\n    this.$filterBtn.removeClass('active');\n\n    if (this.getFilterHud()) {\n      this.$filterBtn\n        .attr('aria-controls', this.getFilterHud().id)\n        .attr('aria-expanded', this.getFilterHud().showing ? 'true' : 'false');\n\n      if (this.getFilterHud().showing || this.getFilterHud().hasRules()) {\n        this.$filterBtn.addClass('active');\n      }\n    } else {\n      this.$filterBtn.attr('aria-controls', null);\n    }\n  },\n\n  serializeConditionForm: function () {\n    if (!this.getFilterHud()) {\n      return null;\n    }\n\n    const el = this.getFilterHud().$body.find('.condition-container:first');\n    let _ = {};\n\n    $.map(el.serializeArray(), function (n) {\n      const keys = n.name.match(/[a-zA-Z0-9_\\\\]+|(?=\\[\\])/g);\n      console.log(keys);\n      if (keys.length > 1) {\n        let tmp = _;\n        let pop = keys.pop();\n        for (let i = 0; i < keys.length; i++) {\n          let j = keys[i];\n          (tmp[j] = !tmp[j] ? (pop == '' ? [] : {}) : tmp[j]), (tmp = tmp[j]);\n        }\n        if (pop == '') {\n          tmp = !Array.isArray(tmp) ? [] : tmp;\n          tmp.push(n.value);\n        } else {\n          tmp[pop] = n.value;\n        }\n      } else {\n        _[keys.pop()] = n.value;\n      }\n    });\n\n    return _;\n  },\n\n  getFilterHudKey: function () {\n    return `site-${this.settings.siteId}`;\n  },\n\n  createFilterHud: function () {\n    this.filterHuds[this.getFilterHudKey()] =\n      new Craft.Commerce.CatalogPricingHud(this, this.settings.siteId);\n  },\n\n  getFilterHud: function () {\n    if (Object.keys(this.filterHuds).indexOf(this.getFilterHudKey()) === -1) {\n      return null;\n    }\n\n    return this.filterHuds[this.getFilterHudKey()];\n  },\n\n  destroyFilterHud: function () {\n    if (this.getFilterHud()) {\n      delete this.filterHuds[this.getFilterHudKey()];\n    }\n  },\n\n  updateTableIfSearchTextChanged: function () {\n    if (\n      this.searchText !==\n      (this.searchText = this.searching ? this.$search.val() : null)\n    ) {\n      this.updateTable();\n    }\n  },\n\n  updateTable: function () {\n    let params = {\n      searchText: this.$search.val(),\n      siteId: this.settings.siteId,\n      condition: this.serializeConditionForm(),\n    };\n\n    Craft.sendActionRequest('POST', 'commerce/catalog-pricing/prices', {\n      data: params,\n    }).then((response) => {\n      if (response.data && response.data.tableHtml) {\n        Craft.appendHeadHtml(response.data.headHtml);\n        Craft.appendBodyHtml(response.data.bodyHtml);\n\n        this.$tableContainer.html(response.data.tableHtml);\n      }\n    });\n  },\n});\n\nCraft.Commerce.CatalogPricingHud = Garnish.HUD.extend({\n  view: null,\n  siteId: null,\n  id: null,\n  loading: true,\n  serialized: null,\n  $clearBtn: null,\n  cleared: false,\n\n  init: function (view, siteId) {\n    this.view = view;\n\n    this.siteId = siteId;\n    this.id = `filter-${Math.floor(Math.random() * 1000000000)}`;\n\n    const $loadingContent = $('<div/>')\n      .append(\n        $('<div/>', {\n          class: 'spinner',\n        })\n      )\n      .append(\n        $('<div/>', {\n          text: Craft.t('app', 'Loading'),\n          class: 'visually-hidden',\n          'aria-role': 'alert',\n        })\n      );\n\n    this.base(this.view.$filterBtn, $loadingContent, {\n      hudClass: 'hud element-filter-hud loading',\n    });\n\n    this.$hud.attr({\n      id: this.id,\n      'aria-live': 'polite',\n      'aria-busy': 'false',\n    });\n    this.$tip.remove();\n    this.$tip = null;\n\n    this.$body.on('submit', (ev) => {\n      ev.preventDefault();\n      this.hide();\n    });\n\n    Craft.sendActionRequest('POST', 'commerce/catalog-pricing/filter', {\n      data: {\n        condition: this.view.settings.condition,\n        id: `${this.id}-filters`,\n      },\n    })\n      .then((response) => {\n        this.loading = false;\n        this.$hud.removeClass('loading');\n        $loadingContent.remove();\n\n        this.$main.append(response.data.hudHtml);\n        Craft.appendHeadHtml(response.data.headHtml);\n        Craft.appendBodyHtml(response.data.bodyHtml);\n        this.view.settings.condition = response.data.condition;\n        this.serialized = this.view.serializeConditionForm();\n\n        const $btnContainer = $('<div/>', {\n          class: 'flex flex-nowrap',\n        }).appendTo(this.$main);\n        $('<div/>', {\n          class: 'flex-grow',\n        }).appendTo($btnContainer);\n        this.$clearBtn = $('<button/>', {\n          type: 'button',\n          class: 'btn',\n          text: Craft.t('app', 'Cancel'),\n        }).appendTo($btnContainer);\n        $('<button/>', {\n          type: 'submit',\n          class: 'btn secondary',\n          text: Craft.t('app', 'Apply'),\n        }).appendTo($btnContainer);\n        this.$clearBtn.on('click', () => {\n          this.clear();\n        });\n\n        this.$hud.find('.condition-container').on('htmx:beforeRequest', () => {\n          this.setBusy();\n        });\n\n        this.$hud.find('.condition-container').on('htmx:load', () => {\n          this.setReady();\n          this.updateSizeAndPosition(true);\n        });\n        this.setFocus();\n      })\n      .catch(() => {\n        Craft.cp.displayError(Craft.t('app', 'A server error occurred.'));\n      });\n\n    this.$hud.css('position', 'fixed');\n\n    this.addListener(Garnish.$win, 'scroll,resize', () => {\n      this.updateSizeAndPosition(true);\n    });\n  },\n\n  addListener: function (elem, events, data, func) {\n    if (elem === this.$main && events === 'resize') {\n      return;\n    }\n    this.base(elem, events, data, func);\n  },\n\n  setBusy: function () {\n    this.$hud.attr('aria-busy', 'true');\n\n    $('<div/>', {\n      class: 'visually-hidden',\n      text: Craft.t('app', 'Loading'),\n    }).insertAfter(this.$main.find('.htmx-indicator'));\n  },\n\n  setReady: function () {\n    this.$hud.attr('aria-busy', 'false');\n  },\n\n  setFocus: function () {\n    Garnish.setFocusWithin(this.$main);\n  },\n\n  clear: function () {\n    this.cleared = true;\n    this.destroy();\n    this.hide();\n  },\n\n  updateSizeAndPositionInternal: function () {\n    const searchOffset = this.view.$searchContainer[0].getBoundingClientRect();\n\n    // Ensure HUD is scrollable if content falls off-screen\n    const windowHeight = Garnish.$win.height();\n    let hudHeight;\n    const availableSpace = windowHeight - searchOffset.bottom;\n\n    if (this.$body.height() > availableSpace) {\n      hudHeight = windowHeight - searchOffset.bottom - 10;\n    }\n\n    this.$hud.css({\n      width: this.view.$searchContainer.outerWidth() - 2,\n      top: searchOffset.top + this.view.$searchContainer.outerHeight(),\n      left: searchOffset.left + 1,\n      height: hudHeight ? `${hudHeight}px` : 'unset',\n      overflowY: hudHeight ? 'scroll' : 'unset',\n    });\n  },\n\n  onShow: function () {\n    this.base();\n\n    // Cancel => Clear\n    if (this.$clearBtn && this.hasRules()) {\n      this.$clearBtn.text(Craft.t('app', 'Clear'));\n    } else if (this.$clearBtn && !this.hasRules()) {\n      this.$clearBtn.text(Craft.t('app', 'Cancel'));\n    }\n\n    this.view.updateFilterBtn();\n    this.setFocus();\n  },\n\n  onHide: function () {\n    this.base();\n\n    // If something changed, update the elements\n    if (\n      this.serialized !== (this.serialized = this.view.serializeConditionForm())\n    ) {\n      this.view.updateTable();\n    }\n\n    if (!this.cleared) {\n      this.$hud.detach();\n      this.$shade.detach();\n    }\n\n    this.view.updateFilterBtn();\n    this.view.$filterBtn.focus();\n  },\n\n  hasRules: function () {\n    return this.$main.has('.condition-rule').length !== 0;\n  },\n\n  destroy: function () {\n    this.base();\n\n    if (this.view.getFilterHud()) {\n      this.view.destroyFilterHud();\n    }\n  },\n});\n"],"names":["Craft","Commerce","CatalogPricing","Garnish","Base","extend","$clearSearchBtn","$filterBtn","$search","$searchContainer","$tableContainer","filterHuds","searchTimeout","searching","view","defaults","init","tableContainer","settings","this","find","children","setSettings","filterBtnActive","addClass","addListener","val","startSearching","stopSearching","clearTimeout","setTimeout","updateTableIfSearchTextChanged","bind","clearSearch","isMobileBrowser","trigger","removeClass","updateTable","searchText","showFilterHud","getFilterHud","show","createFilterHud","updateFilterBtn","attr","id","showing","hasRules","serializeConditionForm","el","$body","_","$","map","serializeArray","n","keys","name","match","console","log","length","tmp","pop","i","j","Array","isArray","push","value","getFilterHudKey","siteId","CatalogPricingHud","Object","indexOf","destroyFilterHud","params","condition","sendActionRequest","data","then","response","tableHtml","appendHeadHtml","headHtml","appendBodyHtml","bodyHtml","html","HUD","loading","serialized","$clearBtn","cleared","Math","floor","random","$loadingContent","append","class","text","t","base","hudClass","$hud","$tip","remove","on","ev","preventDefault","hide","$main","hudHtml","$btnContainer","appendTo","type","clear","setBusy","setReady","updateSizeAndPosition","setFocus","cp","displayError","css","$win","elem","events","func","insertAfter","setFocusWithin","destroy","updateSizeAndPositionInternal","hudHeight","searchOffset","getBoundingClientRect","windowHeight","height","availableSpace","bottom","width","outerWidth","top","outerHeight","left","overflowY","onShow","onHide","detach","$shade","focus","has"],"sourceRoot":""}